---
title: CAP理论
updated: 2022-10-19T07:49:30
created: 2022-10-12T14:18:45
---

**分布式CAP理论：**

分布式系统不可能同时很好的满足CAP这三个需求。

C：Consistency（一致性），集群越大，数据不一致的问题越可能发生。数据的备份复制又可分为强同步复制（主副全部写入成功才成功），异步复制（主成功，副慢慢复制）。

A：Availability（可用性），也就是集群，挂了一个其他的继续工作。

P：Partition tolerance（分区容错性），集群越大，出错概率越大，需要要求集群自动容错。

**根据CAP原理，可以分为三大类：**
1.  **AP模式**
一致性低一些，但高可用且高容错。要求**最终一致性**

**1）eureka服务注册与发现中心集群**

新增一个eureka实例时，集群中的实例是同步复制其注册的服务实例数据。在节点A正复制时，被复制的节点挂掉，此时A的数据和其他正常节点的数据就不一致了。

**2）mysql与redis集群**

mysql和redis的数据复制都是采用的异步复制，所以mysql与redis集群都属于AP类型，在集群中获取数据时，会存在数据不一致的情况。
1.  **CP模式**
可用性低一些，但一致性和容错性高。要求**强一致性**。

**1）zookeeper集群**

与eureka不用，zookeeper采用一个Leader（读写）和多个Follower（只读）模式，采用强同步复制。

当同步复制出现错误时，为了保证C，必须将某个节点设置为不可用，就丧失了A的性质。
1.  CA-单点集群
一般来说，分布式系统无法舍弃P性质，所以这个CA基本没用。

满足一致性，可用性的系统，通常在可扩展性上不太强大，基本不用。

NoSQL运动的主题其实是创造各种可用性优先、数据一致性其次的方案；而传统数据库坚守ACID特性(原子性、一致性、隔离性、持久性)，做的是相反的事情。

总结：分布式一定有P容错性，而A与C在分布式情况下不可兼得

