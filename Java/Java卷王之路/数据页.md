---
title: 数据页
updated: 2022-10-12T10:38:43
created: 2022-10-12T10:26:54
---

**基本概念：**
文件系统的最小单元是磁盘块block，一个块4K，系统读取数据到内存时以磁盘块block为基本单位，位于同一个block中的数据会被一次性读取出来，而不是需要什么取什么。
InnoDB存储引擎中有页（Page）的概念，页是 MySQL 磁盘管理的最小单位。
- InnoDB存储引擎中，默认每个页的大小为 **16KB**，索引中一个节点就是一个数据页（是因为B+Tree优化过的），所以会一次性读取 16KB 的数据到内存。
- InnoDB引擎将若干个地址连接磁盘块，以此来达到页的大小 16KB
- 在查询数据时如果一个页中的每条数据都能有助于定位数据记录的位置，这将会减少磁盘 I/O 次数，提高查询效率
- 超过 16KB 的一条记录，主键索引页只会存储部分数据和指向溢出页的指针，剩余数据都会分散存储在溢出页中（**页分裂**）

**索引维护而导致的情况：**
**B+树**为了保持索引的有序性，在插入新值时需要做相应的维护。（所有的这些都是因为B+Tree的特性决定的）
1.  页分裂
如果所在的数据页已经满了，这时候需要申请一个新的数据页，然后挪动部分数据过去。原本放在一个页的数据现在分到两个页中，降低了空间利用率，多一次IO。
1.  页合并
相邻两个页由于删除了数据，利用率很低之后，会将数据页做合并，合并的过程可以认为是分裂过程的逆过程。

**避免页分裂：**
1.  选用数据小的字段做索引，字段长度越小，普通索引的叶子节点就越小，普通索引占用的空间也就越小
2.  自增主键的插入数据模式，可以让主键索引尽量地保持递增顺序插入，不涉及到挪动其他记录。页分裂的目的就是保证后一个数据页中的所有行主键值比前一个数据页中主键值大

