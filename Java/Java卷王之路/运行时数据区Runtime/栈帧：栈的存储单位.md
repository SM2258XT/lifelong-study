---
title: 栈帧：栈的存储单位
updated: 2022-09-13T13:34:52
created: 2022-05-04T19:54:05
---

栈中存储什么？
1\. 每个线程都有自己的栈，栈中的数据都是以**栈帧**（Stack Frame）的格式存在，**每个方法**都各自对应**一个栈帧**（Stack Frame）。
3\. 栈帧是一个内存区块，是一个数据集，维系着方法执行过程中的各种数据信息。

- 在一条活动线程中，一个时间点上，只会有一个活动的栈帧。即只有当前正在执行的方法的栈帧（栈顶栈帧）是有效的。这个栈帧被称为当前栈帧（Current Frame）
- 与当前栈帧相对应的方法就是当前方法（Current Method），定义这个方法的类就是当前类（Current Class）
- 如果在该方法中调用了其他方法，对应的新的栈帧会被创建出来，放在栈的顶端，成为新的当前帧。
- 不同线程中所包含的栈帧是不允许存在相互引用的，因为不同线程都是不同的栈了！
- 如果当前方法调用了其他方法，其他方法返回之际，当前栈帧（其他方法）会传回的执行结果给前一个栈帧（调用者），接着，虚拟机会丢弃当前栈帧，使得前一个栈帧重新成为当前栈帧。
- Java方法有两种返回函数的方式。
一种是正常的函数返回，使用return指令。另一种是方法执行中出现未捕获处理的异常，以抛出异常的方式结束。

但不管使用哪种方式，都会导致栈帧被弹出。

每个栈帧中存储着以下5部分，而局部变量表和操作数栈占据了绝大部分空间
1.  **局部变量表**（Local Variables）
2.  **操作数栈**（Operand Stack）（或表达式栈）
3.  动态链接（Dynamic Linking）（或指向运行时常量池的方法引用）
4.  方法返回地址（Return Address）（或方法正常退出或者异常退出的定义）
5.  一些附加信息

![](C:\Users\82609\AppData\Local\Temp\Java\pandoc/media/image1.png)![](C:\Users\82609\AppData\Local\Temp\Java\pandoc/media/image2.png)
