---
title: RabbitMQ集群可用性
updated: 2023-02-27T08:13:30
created: 2022-10-28T07:41:29
---

RabbitMQ集群可用性
2022年10月28日
7:41

**两种集群模式**
- **普通集群：无高可用性**
多台机器上，创建多个MQ实例。
- 创建时：创建的Queue**只会放在其中一个**MQ实例上，其他实例进行元数据同步（元数据只包含基本信息，例如真实Queue节点ip、配置信息等，不是实际数据）
- 消费时：如果请求的不是Queue所在实例，则先会进行数据同步，然后再返回给请求者。（而**不是重定向**到Queue所在实例）
优点：

吞吐量高。多个节点分摊压力。

缺点：
- MQ内部可能产生大量数据传输（数据同步）
- 可用性无保障。Queue所在节点挂了，此时集群肯定挂，而且只有配置了持久化，并花费时间才能恢复数据。
- **镜像集群：可用性高，但不算是分布式**
每个节点都有完整的数据
- 创建时：创建的Queue会**全量同步**到所有节点（而不仅是元数据）
- 消费时：所有节点同步数据
优点：

可用性高。毕竟每个节点都是全量数据！

缺点：
- 同步性能开销大
- 不算是分布式，没有扩展性而言。如果某个节点负载很重，新增的机器也包含了这个节点的全量数据，并没有办法线性扩展

![](C:\Users\82609\AppData\Local\Temp\Java\pandoc/media/image1.png)![](C:\Users\82609\AppData\Local\Temp\Java\pandoc/media/image2.png)
